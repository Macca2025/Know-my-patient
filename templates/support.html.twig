{% extends 'layouts/base.html.twig' %}
{% block content %}
<!-- Main Layout -->

<div class="d-flex flex-column min-vh-100 admin-main">
    <main class="flex-grow-1 main-content mb-5">
        <div class="container-xxl py-4">
            <!-- Header Section -->
            <div class="admin-header section-gradient-light rounded-4 shadow-sm mb-4 p-4" style="margin-top:25px">
                <div class="d-flex align-items-center justify-content-between">
                    <div class="">
                        <h1 class="fw-bold text-purple-primary mb-2">
                            <i class="bi bi-headset me-2"></i>Support Center
                        </h1>
                        <p class="lead text-secondary mb-0">Get help, find answers, or contact our support team</p>
                    </div>
                </div>
            </div>


            <div class="row g-4 justify-content-center">
                <!-- FAQ Accordion Section -->
                <div class="col-12 col-lg-6">
                    <div class="card h-100 shadow border-0 profile-card support-card section-gradient-light">
                        <div class="card-header section-gradient-light text-dark text-center">
                            <div class="text-center">
                                <i class="bi bi-question-circle fs-1 mb-2"></i>
                                <h5 class="card-title fw-bold mb-0 text-purple-primary">Frequently Asked Questions</h5>
                            </div>
                        </div>
                        <div class="card-body support-form">
                            <p class="text-center text-muted mb-4">Find quick answers to common questions</p>
                            <div class="accordion" id="supportAccordion">
                                
                                <!-- FAQ Item 1 -->
                                <div class="accordion-item">
                                    <h4 class="accordion-header" id="faq1">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1" aria-expanded="false" aria-controls="collapse1">
                                            <i class="bi bi-person-circle me-2 text-info"></i>
                                            How do I create an account?
                                        </button>
                                    </h4>
                                    <div id="collapse1" class="accordion-collapse collapse" aria-labelledby="faq1" data-bs-parent="#supportAccordion">
                                        <div class="accordion-body">
                                            <p>Creating an account is simple:</p>
                                            <ol>
                                                <li>Click the "Register" button in the top navigation</li>
                                                <li>Fill in your personal information</li>
                                                <li>Choose your user type (Patient, Family Member, or NHS Staff)</li>
                                                <li>Verify your email address</li>
                                                <li>Start using your Digital Hospital Passport!</li>
                                            </ol>
                                            <p><strong>Note:</strong> NHS staff accounts require additional email verification with an official NHS email address.</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- FAQ Item 2 -->
                                <div class="accordion-item">
                                    <h4 class="accordion-header" id="faq2">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="false" aria-controls="collapse2">
                                            <i class="bi bi-shield-check me-2 text-success"></i>
                                            Is my medical information secure?
                                        </button>
                                    </h4>
                                    <div id="collapse2" class="accordion-collapse collapse" aria-labelledby="faq2" data-bs-parent="#supportAccordion">
                                        <div class="accordion-body">
                                            <p>Yes, your medical information is highly secure:</p>
                                            <ul>
                                                <li><strong>Encryption:</strong> All data is encrypted both in transit and at rest</li>
                                                <li><strong>Access Control:</strong> Only authorized healthcare professionals can access your records</li>
                                                <li><strong>Audit Trail:</strong> Every access to your records is logged and monitored</li>
                                                <li><strong>GDPR Compliance:</strong> We fully comply with UK data protection laws</li>
                                                <li><strong>NHS Standards:</strong> Our security meets NHS Digital requirements</li>
                                            </ul>
                                            <p>You have full control over who can access your information and can revoke access at any time.</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- FAQ Item 3 -->
                                <div class="accordion-item">
                                    <h4 class="accordion-header" id="faq3">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3" aria-expanded="false" aria-controls="collapse3">
                                            <i class="bi bi-qr-code me-2 text-warning"></i>
                                            How do I share my medical records with healthcare staff?
                                        </button>
                                    </h4>
                                    <div id="collapse3" class="accordion-collapse collapse" aria-labelledby="faq3" data-bs-parent="#supportAccordion">
                                        <div class="accordion-body">
                                            <p>Sharing your medical records is quick and secure:</p>
                                            <ol>
                                                <li>Log into your account and go to your dashboard</li>
                                                <li>Click "Share My Records" to generate your QR code</li>
                                                <li>Show the QR code to the healthcare professional</li>
                                                <li>They scan it with their NHS device or app</li>
                                                <li>Your records are instantly accessible to them</li>
                                            </ol>
                                            <p><strong>Security:</strong> QR codes expire automatically for security, and you can see who has accessed your records.</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- FAQ Item 4 -->
                                <div class="accordion-item">
                                    <h4 class="accordion-header" id="faq4">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4" aria-expanded="false" aria-controls="collapse4">
                                            <i class="bi bi-phone me-2 text-danger"></i>
                                            I forgot my password. How can I reset it?
                                        </button>
                                    </h4>
                                    <div id="collapse4" class="accordion-collapse collapse" aria-labelledby="faq4" data-bs-parent="#supportAccordion">
                                        <div class="accordion-body">
                                            <p>To reset your password:</p>
                                            <ol>
                                                <li>Go to the login page</li>
                                                <li>Click "Forgot password?" link</li>
                                                <li>Enter your email address</li>
                                                <li>Check your email for a reset link</li>
                                                <li>Follow the link to create a new password</li>
                                            </ol>
                                            <p><strong>Note:</strong> Password reset links expire after 1 hour for security reasons.</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- FAQ Item 5 -->
                                <div class="accordion-item">
                                    <h4 class="accordion-header" id="faq5">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5" aria-expanded="false" aria-controls="collapse5">
                                            <i class="bi bi-hospital me-2 text-primary"></i>
                                            Can family members access my records?
                                        </button>
                                    </h4>
                                    <div id="collapse5" class="accordion-collapse collapse" aria-labelledby="faq5" data-bs-parent="#supportAccordion">
                                        <div class="accordion-body">
                                            <p>Family member access depends on your privacy settings:</p>
                                            <ul>
                                                <li><strong>Default:</strong> Family members cannot access your records without permission</li>
                                                <li><strong>Emergency Access:</strong> You can designate emergency contacts who can access critical information</li>
                                                <li><strong>Sharing Controls:</strong> You can share specific information with family members</li>
                                                <li><strong>Temporary Access:</strong> Grant time-limited access for specific situations</li>
                                            </ul>
                                            <p>All family member access is logged and you can revoke permissions at any time in your privacy settings.</p>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
 <!-- Contact Form Section -->
                <div class="col-12 col-lg-6">
                    <div class="card h-100 shadow border-0 profile-card support-card section-gradient-light">
                        <div class="card-header section-gradient-light text-dark text-center">
                            <div class="text-center">
                                <i class="bi bi-envelope fs-1 mb-2 text-success"></i>
                                <h5 class="card-title fw-bold mb-0 text-purple-primary">Contact Support</h5>
                            </div>
                        </div>
                        <div class="card-body support-form">
                            {# Success and error messages #}
                            {% if success is defined and success %}
                                <div class="alert alert-success text-center">Thank you for your message! Our support team will contact you soon.</div>
                            {% elseif errors is defined and errors %}
                                {% if errors.general is defined %}
                                    <div class="alert alert-danger text-center">{{ errors.general }}</div>
                                {% endif %}
                            {% endif %}
                            <p class="text-center text-muted mb-4">Send us a message and we'll help you out</p>
                            <form method="post" action="{{ url_for(support_route) }}" id="supportForm">
                                {# CSRF token fields #}
                                {% if csrf is defined %}
                                    <input type="hidden" name="{{ csrf.keys.name }}" value="{{ csrf.name }}">
                                    <input type="hidden" name="{{ csrf.keys.value }}" value="{{ csrf.value }}">
                                {% endif %}
                                <div class="mb-3">
                                    <label for="name" class="form-label">
                                        <i class="bi bi-person me-1"></i>Your Name <span class="text-danger">*</span>
                                    </label>
                                    <input type="text"
                                           class="form-control"
                                           id="name"
                                           name="name"
                                           value="{{ currentUser is defined and currentUser ? currentUser.first_name ~ ' ' ~ currentUser.surname : form.name|default('') }}"
                                           required>
                                </div>

                                <div class="mb-3">
                                    <label for="email" class="form-label">
                                        <i class="bi bi-envelope me-1"></i>Email Address <span class="text-danger">*</span>
                                    </label>
                                    <input type="email"
                                           class="form-control"
                                           id="email"
                                           name="email"
                                           value="{{ currentUser is defined and currentUser ? currentUser.email : form.email|default('') }}"
                                           required>
                                </div>

                                <div class="mb-3">
                                    <label for="subject" class="form-label">
                                        <i class="bi bi-tag me-1"></i>Subject <span class="text-danger">*</span>
                                    </label>
                                    <select class="form-select" id="subject" name="subject" required>
                                        <option value="">Select a topic...</option>
                                        <option value="account" {{ form.subject is defined and form.subject == 'account' ? 'selected' : '' }}>Account Issues</option>
                                        <option value="technical" {{ form.subject is defined and form.subject == 'technical' ? 'selected' : '' }}>Technical Problems</option>
                                        <option value="privacy" {{ form.subject is defined and form.subject == 'privacy' ? 'selected' : '' }}>Privacy Concerns</option>
                                        <option value="medical" {{ form.subject is defined and form.subject == 'medical' ? 'selected' : '' }}>Medical Records</option>
                                        <option value="nhs" {{ form.subject is defined and form.subject == 'nhs' ? 'selected' : '' }}>NHS Staff Access</option>
                                        <option value="feature" {{ form.subject is defined and form.subject == 'feature' ? 'selected' : '' }}>Feature Request</option>
                                        <option value="other" {{ form.subject is defined and form.subject == 'other' ? 'selected' : '' }}>Other</option>
                                    </select>
                                </div>

                                <div class="mb-4">
                                    <label for="message" class="form-label">
                                        <i class="bi bi-chat-text me-1"></i>Message <span class="text-danger">*</span>
                                    </label>
                                    <textarea class="form-control"
                                              id="message"
                                              name="message"
                                              rows="4"
                                              placeholder="Please describe your question or issue in detail..."
                                              required>{{ form.message|default('') }}</textarea>
                                </div>

                                <div class="d-grid">
                                    <button type="submit" name="submit_support" value="1" class="btn btn-modern-outline-primary w-100 mb-4">
                                        <i class="bi bi-send me-2"></i>Send Message
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    {% endblock %}

